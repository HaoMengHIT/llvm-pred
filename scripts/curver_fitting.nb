#!/usr/bin/env WolframScript -script

(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       196,          9]
NotebookDataLength[     48302,       1293]
NotebookOptionsPosition[     47304,       1258]
NotebookOutlinePosition[     47639,       1273]
CellTagsIndexPosition[     47596,       1270]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"X_Integer", ",", "Content_String"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", "Content"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"StringCases", "[", 
        RowBox[{"r", ",", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<(\\\\d+)/[0-9.e+-]+\\\\s+(\\\\w+\\\\(\\\\) - .*)\>\"", "]"}], 
          "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"\"\<$2\>\"", "\[Rule]", "\"\<$1\>\""}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"X", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ReadList", "[", 
            RowBox[{
             RowBox[{"StringToStream", "[", "#", "]"}], ",", "Real"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Association", "[", "r", "]"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"X_Integer", ",", "Bitcode_String", ",", "Out_String"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"RunProcess", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<llvm-prof\>\"", ",", "\"\<-list-all\>\"", ",", 
           "\"\<-unsort\>\"", ",", "Bitcode", ",", "Out"}], "}"}], ",", 
         "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "\"\<ExitCode\>\"", "]"}], "\[NotEqual]", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"r", "[", "\"\<StandardError\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"ProfileLoad", "[", 
           RowBox[{"X", ",", 
            RowBox[{"r", "[", "\"\<StandardOutput\>\"", "]"}]}], "]"}], ",", 
          "Out"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProfileLoad", "[", 
   RowBox[{
   "X_Integer", ",", "Bitcode_String", ",", "Out_String", ",", "Predict"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"ProfileLoad", "[", 
     RowBox[{"X", ",", "Bitcode", ",", "Out"}], "]"}], ",", "Predict"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProfileLoad", "::", "usage"}], "=", 
    "\"\<Load data from llvm-prof Output Text or Binary File\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProfileHotLoad", "[", 
    RowBox[{"X_Integer", ",", "Bitcode_String", ",", "Out_String"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"RunProcess", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<llvm-prof\>\"", ",", "Bitcode", ",", "Out"}], "}"}], 
         ",", "All"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "\"\<ExitCode\>\"", "]"}], "\[NotEqual]", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"r", "[", "\"\<StandardError\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ProfileLoad", "[", 
         RowBox[{"X", ",", 
          RowBox[{"r", "[", "\"\<StandardOutput\>\"", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProfileHotLoad", "::", "usage"}], "=", 
    "\"\<Load Top 20 data from llvm-prof Output Binary File\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsPredicted", "[", "P_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"Last", "[", "P", "]"}], "\[Equal]", "Predict"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FitLoad", "[", "Content_String", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", "Content"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"StringCases", "[", 
        RowBox[{"r", ",", 
         RowBox[{
          RowBox[{
          "RegularExpression", "[", 
           "\"\<func:(\\\\d+)\\\\s+args:(([0-9.e+-]+ \
)+)\\\\s+(\\\\w+\\\\(\\\\) - .*)\>\"", "]"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<$4\>\"", "\[Rule]", "\"\<$1 $2\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ReadList", "[", 
         RowBox[{
          RowBox[{"StringToStream", "[", "#", "]"}], ",", "Real"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"Association", "[", "r", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FitLoad", "[", 
    RowBox[{"Bitcode_String", ",", "Profile_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"RunProcess", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<../build/src/curve-fit\>\"", ",", "Bitcode", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<:\>\"", "<>", 
              RowBox[{"i", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "Profile"}], "}"}]}], "]"}]}], "}"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "\"\<ExitCode\>\"", "]"}], "\[NotEqual]", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"r", "[", "\"\<StandardError\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FitLoad", "[", 
         RowBox[{"r", "[", "\"\<StandardOutput\>\"", "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FitLoad", "::", "usage"}], " ", "=", " ", 
    "\"\<Load Result from curve-fit Text Output\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockName", "[", 
   RowBox[{"{", 
    RowBox[{"X_", ",", "A_Association", ",", "___"}], "}"}], "]"}], ":=", 
  RowBox[{"Keys", "[", "A", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockName", "[", "A_Association", "]"}], ":=", 
  RowBox[{"Keys", "[", "A", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BlockName", "::", "usage"}], " ", "=", " ", 
    "\"\<Get block names from ProfileLoad or FitLoad\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetAxis", "[", 
   RowBox[{"P_", ",", "Name_String"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"P", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", "Name", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6239326675027456`*^9, {3.6243087410625753`*^9, 3.6243087756534986`*^9}, {
   3.6243088163088503`*^9, 3.6243088304969683`*^9}, {3.624310304230864*^9, 
   3.624310315870562*^9}, {3.6243103783335037`*^9, 3.6243104282377377`*^9}, 
   3.624310482130431*^9, {3.624310531510653*^9, 3.624310589003894*^9}, {
   3.624310665228582*^9, 3.6243106669265223`*^9}, {3.6243106978543053`*^9, 
   3.6243107173250504`*^9}, {3.624312915335041*^9, 3.6243129991501017`*^9}, {
   3.624313229303453*^9, 3.624313266026905*^9}, {3.624313537267571*^9, 
   3.624313714688715*^9}, {3.624314511638818*^9, 3.624314516206065*^9}, {
   3.6243152856601467`*^9, 3.6243153510273743`*^9}, {3.624315437070203*^9, 
   3.624315463285421*^9}, {3.624315545604801*^9, 3.624315648594595*^9}, {
   3.624315839438909*^9, 3.6243158864302893`*^9}, {3.624315931950264*^9, 
   3.624315961685151*^9}, {3.6243165949165792`*^9, 3.624316608783638*^9}, {
   3.6243166689042253`*^9, 3.624316740100029*^9}, {3.6243170498342457`*^9, 
   3.6243170520538073`*^9}, {3.624317490394453*^9, 3.6243175161707993`*^9}, 
   3.6243184062663097`*^9, {3.624325323013669*^9, 3.624325338952395*^9}, {
   3.624325389290594*^9, 3.624325471387513*^9}, {3.6243255127981377`*^9, 
   3.624325533677661*^9}, 3.624359806186482*^9, {3.624359949744924*^9, 
   3.624359950895145*^9}, {3.6243623119502583`*^9, 3.6243623150695868`*^9}, {
   3.624394459434774*^9, 3.624394493544856*^9}, {3.624394557248137*^9, 
   3.62439457369405*^9}, {3.624394604273929*^9, 3.624394722100935*^9}, {
   3.624394887825842*^9, 3.624394894138626*^9}, {3.624395263434718*^9, 
   3.6243953393522673`*^9}, {3.624395413753389*^9, 3.624395433893614*^9}, {
   3.624399955881402*^9, 3.6243999609711637`*^9}, {3.624602411944993*^9, 
   3.624602420651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:5171\:670931\:4e2a\:51fd\:6570\:5f62\:5f0f\:53c2\:4e0e\:62df\:5408\
", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.0", ",", "a_", ",", "b_", ",", "___"}], "}"}], ",", "x_"}], 
     "]"}], ":=", 
    RowBox[{"a", "*", 
     SuperscriptBox["x", "b"]}]}], "\n", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.0", ",", "a_", ",", "b_", ",", "___"}], "}"}], ",", "x_"}], 
     "]"}], ":=", 
    RowBox[{"a", "*", 
     SuperscriptBox["b", "x"]}]}], "\n", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "-", 
     RowBox[{"b", "*", 
      SuperscriptBox["c", "x"]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3.0", ",", "a_", ",", "b_", ",", "___"}], "}"}], ",", "x_"}], 
     "]"}], ":=", 
    RowBox[{"1", "-", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"a", "*", "x"}]}], ")"}], "b"]]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", "x"}], "+", 
     RowBox[{"c", "*", 
      SuperscriptBox["x", "2"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "*", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"b", "*", "x"}], "+", "c"}]]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"6.0", ",", "a_", ",", "b_", ",", "___"}], "}"}], ",", "x_"}], 
     "]"}], ":=", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "b"}], "*", "x"}]]}], ")"}]}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"7.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      SuperscriptBox["x", "c"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "c"}], "*", "x"}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"9.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "x"}], "/", "c"}]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"10.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    SuperscriptBox["a", 
     FractionBox["b", 
      RowBox[{"x", "+", "c"}]]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"11.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"x", "-", "b"}], ")"}], "c"]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"12.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "+", 
       RowBox[{"b", "*", "x"}]}], ")"}], 
     FractionBox[
      RowBox[{"-", "1"}], "c"]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"13.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "-", 
     RowBox[{"b", "*", 
      RowBox[{"Log", "[", 
       RowBox[{"x", "+", "c"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"14.0", ",", "a_", ",", "b_", ",", "___"}], "}"}], ",", "x_"}],
      "]"}], ":=", 
    RowBox[{"a", "*", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"a", "*", "x"}], "-", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"15.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "b"}], "*", 
         RowBox[{"(", 
          RowBox[{"x", "-", "c"}], ")"}]}]]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"16.0", ",", "a_", ",", "___"}], "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", "a", "]"}]}], "*", 
     SuperscriptBox["a", "x"]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "17.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"a", "+", 
      RowBox[{"b", "*", "x"}]}], 
     RowBox[{"c", "+", 
      RowBox[{"d", "*", "x"}]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"18.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    FractionBox["a", 
     RowBox[{"1", "+", 
      RowBox[{"b", "*", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "c"}], "*", "x"}]]}]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"19.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    FractionBox["a", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "b"}], "*", 
        RowBox[{"(", 
         RowBox[{"x", "-", "c"}], ")"}]}]]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"20.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"a", "+", 
      RowBox[{"b", "*", "x"}], "+", 
      RowBox[{"c", "*", 
       SuperscriptBox["x", "2"]}]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "21.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "*", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"-", "x"}], "b"]]}], "+", "c", "+", 
     RowBox[{"d", "*", "x"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"22.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    FractionBox["1", 
     RowBox[{"a", "+", 
      RowBox[{"b", "*", 
       SuperscriptBox["x", "c"]}]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "23.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", "x"}], "+", 
     RowBox[{"c", "*", 
      SuperscriptBox["d", "x"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "24.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"x", "-", "c"}], ")"}]}], "d"]]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    FractionBox["a", 
     RowBox[{"a", "+", 
      RowBox[{"b", "*", "x"}], "+", 
      RowBox[{"c", "*", 
       SuperscriptBox["x", "2"]}]}]]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "26.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "*", 
     FractionBox["x", 
      RowBox[{"b", "+", 
       RowBox[{"c", "*", "x"}], "+", 
       RowBox[{"d", "*", 
        SuperscriptBox["x", "2"]}]}]]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "27.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "___"}], 
       "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", "x"}], "+", 
     RowBox[{"c", "*", 
      SuperscriptBox["x", "2"]}], "+", 
     RowBox[{"d", "*", 
      SuperscriptBox["x", "3"]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "28.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_", ",", 
        "___"}], "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"-", "x"}], "c"]]}], "+", 
     RowBox[{"d", "*", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"-", "x"}], "e"]]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "29.0", ",", "a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_", ",", 
        "___"}], "}"}], ",", "x_"}], "]"}], ":=", 
    RowBox[{"a", "+", 
     RowBox[{"b", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"-", "x"}], "c"]]}], ")"}]}], "+", 
     RowBox[{"d", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"-", "x"}], "e"]]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"func", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"30.0", ",", "a_", ",", "b_", ",", "c_", ",", "___"}], "}"}], 
      ",", "x_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"a", "*", "b", "*", 
      SuperscriptBox["x", 
       RowBox[{"1", "-", "c"}]]}], 
     RowBox[{"1", "+", 
      RowBox[{"b", "*", 
       SuperscriptBox["x", 
        RowBox[{"1", "-", "c"}]]}]}]]}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.623932671257128*^9, {3.624313691897634*^9, 3.624313692682499*^9}, {
   3.624318482884309*^9, 3.624318526053092*^9}, {3.6243609031985607`*^9, 
   3.624360918942155*^9}, {3.624398569197919*^9, 3.624398569847636*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\:603b\:5e73\:65b9\:548c", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sem", "[", "Y_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Mean", "[", "Y", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Y", "-", "m"}], ")"}], "2"], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\:6b8b\:5dee\:5e73\:65b9\:548c", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sel", "[", 
      RowBox[{"Y_List", ",", "y_List"}], "]"}], ":=", 
     RowBox[{"Total", "[", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Y", "-", "y"}], ")"}], "2"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\:51b3\:5b9a\:7cfb\:6570", 
      RowBox[{"(", 
       RowBox[{"coefficient", " ", "of", " ", "determination"}], ")"}]}], 
     "\:ff0c", 
     "\:4e00\:4e2a\:5e38\:7528\:7684\:62df\:5408\:8bc4\:4ef7\:6807\:51c6", 
     "\:3002", "\:5176\:503c\:8d8a\:63a5\:8fd11", "\:ff0c", 
     "\:8868\:793a\:62df\:5408\:7684\:8d8a\:597d", "\:3002", 
     "\:4f46\:662f\:5bf9\:4e8e\:8d8b\:52bf\:5e73\:7a33\:7684\:62df\:5408\:6570\
\:636e", "\:ff0c", 
     RowBox[{
     "\:51b3\:5b9a\:7cfb\:6570\:8fbe\:52300", ".9", 
      "\:662f\:5f88\:666e\:904d\:7684"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Decision", "[", 
      RowBox[{"Y_List", ",", "y_List"}], "]"}], ":=", 
     RowBox[{"1", "-", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sem", "[", "Y", "]"}], "\[Equal]", "0"}], ",", "0", ",", 
        "  ", "True", ",", 
        FractionBox[
         RowBox[{"Sel", "[", 
          RowBox[{"Y", ",", "y"}], "]"}], 
         RowBox[{"Sem", "[", "Y", "]"}]]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\:76f8\:5bf9\:8bef\:5dee", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rel", "[", 
     RowBox[{"Y_", ",", "y_"}], "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"Abs", "[", 
       RowBox[{"Y", "-", "y"}], "]"}], "y"], "/;", 
     RowBox[{"Y", ">", "0"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rel", "[", 
     RowBox[{"Y_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"0", "/;", 
     RowBox[{"Y", "\[Equal]", "0"}]}]}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6239326738684797`*^9, {3.6243236480771227`*^9, 3.6243236483713923`*^9}, {
   3.624323956519249*^9, 3.624323960312849*^9}, {3.6243243100762053`*^9, 
   3.624324358481049*^9}, {3.624324429708864*^9, 3.624324430132814*^9}, {
   3.6243245162135553`*^9, 3.6243245395341873`*^9}, {3.6243245934436893`*^9, 
   3.624324640275099*^9}, {3.62432469588454*^9, 3.624324706476266*^9}, {
   3.624324755782481*^9, 3.624324770516433*^9}, {3.6243248126457787`*^9, 
   3.6243248500346117`*^9}, {3.624325000760182*^9, 3.6243250046551456`*^9}, {
   3.624361808355968*^9, 3.62436185272887*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:4ee5\:8868\:683c\:7684\:5f62\:5f0f\:7ed9\:51fa\:62df\:5408\:76f8\
\:5173\:7684\:6570\:636e", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"table", "[", 
     RowBox[{
     "N_", ",", "Train_List", ",", "Test_List", ",", "fit_Association"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"PAll$XY", ",", "PAll$Y", ",", "Pred$XY", ",", "Pred$Y"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PAll$XY", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GetAxis", "[", 
           RowBox[{"#", ",", "N"}], "]"}], "&"}], "/@", "Train"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PAll$Y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"func", "[", 
           RowBox[{
            RowBox[{"fit", "[", "N", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"PAll$XY", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pred$XY", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GetAxis", "[", 
           RowBox[{"#", ",", "N"}], "]"}], "&"}], "/@", "Test"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pred$Y", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"func", "[", 
           RowBox[{
            RowBox[{"fit", "[", "N", "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{"Pred$XY", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "\"\<Fitting Data\>\"", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"SpanFromLeft", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "Train", "]"}], "-", "1"}]}], "]"}], 
              ",", "\"\<Prediction Data\>\"", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"SpanFromLeft", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "Test", "]"}], "-", "1"}]}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<ProcessNum\>\"", ",", 
              RowBox[{"PAll$XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Pred$XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<ActualValue\>\"", ",", 
              RowBox[{"PAll$XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"Pred$XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<FuncValue\>\"", ",", 
              RowBox[{"IntegerPart", "/@", "PAll$Y"}], ",", 
              RowBox[{"IntegerPart", "/@", "Pred$Y"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<RelativeError\>\"", ",", 
              RowBox[{"Rel", "@@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"PAll$XY", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "PAll$Y"}], 
                  "}"}], "\[Transpose]"}], ")"}]}], ",", 
              RowBox[{"Rel", "@@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Pred$XY", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "Pred$Y"}], 
                  "}"}], "\[Transpose]"}], ")"}]}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\!\(\*SuperscriptBox[\(R\), \(2\)]\)\>\"", ",", 
              RowBox[{"Decision", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"PAll$XY", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Union]", 
                 RowBox[{"Pred$XY", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
                RowBox[{"PAll$Y", "\[Union]", "Pred$Y"}]}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"SpanFromLeft", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "Train", "]"}], "-", "2"}]}], "]"}]}],
              "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:4ee5\:66f2\:7ebf\:56fe\:7684\:5f62\:5f0f\:5c55\:793a\:62df\:5408\
\:7ed3\:679c", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graph", "[", 
     RowBox[{"N_", ",", "PAll_List", ",", "Pd_List", ",", "fit_Association"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"XY", ",", "fitFunc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XY", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"GetAxis", "[", 
           RowBox[{"#", ",", "N"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"PAll", "\[Union]", "Pd"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fitFunc", "=", 
        RowBox[{"func", "[", 
         RowBox[{
          RowBox[{"fit", "[", "N", "]"}], ",", "x"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{"fitFunc", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{"XY", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "4"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"N", "<>", "\"\<\\nfunc.\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "[", 
               RowBox[{"fit", "[", "N", "]"}], "]"}], "]"}], "<>", 
             "\"\<   \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"fitFunc", ",", "TraditionalForm"}], "]"}]}]}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"GetAxis", "[", 
                 RowBox[{"#", ",", "N"}], "]"}], "&"}], "/@", "Pd"}], "]"}], 
             ",", 
             RowBox[{"Sort", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"GetAxis", "[", 
                 RowBox[{"#", ",", "N"}], "]"}], "&"}], "/@", "PAll"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"PlotTheme", "\[Rule]", 
            RowBox[{"{", "\"\<OpenMarkers\>\"", "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "2"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Testing\>\"", ",", "\"\<Train\>\""}], "}"}]}], ",", 
           
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.623932684833357*^9, {3.624318886924492*^9, 3.624318905145212*^9}, {
   3.6243189425671997`*^9, 3.6243190441227922`*^9}, {3.624319110085208*^9, 
   3.624319176032978*^9}, {3.6243192500230093`*^9, 3.624319258069333*^9}, 
   3.6243193090205708`*^9, {3.624319398831429*^9, 3.6243194205133867`*^9}, {
   3.624322849079808*^9, 3.624322909757736*^9}, {3.624323042061076*^9, 
   3.624323050927451*^9}, {3.624323225254087*^9, 3.6243232333969*^9}, {
   3.6243232714199266`*^9, 3.6243233592117357`*^9}, {3.624323399006916*^9, 
   3.624323440815839*^9}, {3.6243235622550983`*^9, 3.624323575440593*^9}, {
   3.6243248954570827`*^9, 3.6243249238266773`*^9}, {3.624324958007862*^9, 
   3.624324958220151*^9}, {3.624325551376768*^9, 3.624325574007709*^9}, {
   3.624325766126012*^9, 3.62432576651645*^9}, {3.624325901008795*^9, 
   3.624325904418638*^9}, {3.624326054079887*^9, 3.6243261738167753`*^9}, {
   3.624326261001029*^9, 3.624326376269587*^9}, {3.62435348252302*^9, 
   3.6243534994517117`*^9}, {3.624353626437324*^9, 3.624353686953403*^9}, {
   3.6243545823273573`*^9, 3.624354654094281*^9}, {3.624354749235985*^9, 
   3.624354774742296*^9}, {3.624355202504757*^9, 3.624355226355227*^9}, {
   3.6243554279231043`*^9, 3.62435543386019*^9}, {3.6243556811274433`*^9, 
   3.624355736399597*^9}, {3.6243557979066753`*^9, 3.624355909632386*^9}, {
   3.6243559707337418`*^9, 3.6243559855950747`*^9}, {3.624356092375532*^9, 
   3.6243561403473988`*^9}, {3.624356310935453*^9, 3.6243563605619583`*^9}, {
   3.624356408499155*^9, 3.624356440358473*^9}, {3.624356634755004*^9, 
   3.624356693198764*^9}, {3.624356736015239*^9, 3.6243568748662863`*^9}, {
   3.624356957168256*^9, 3.6243570407137947`*^9}, {3.624357108914123*^9, 
   3.6243571629696703`*^9}, {3.624357197429697*^9, 3.62435720766782*^9}, {
   3.6243572435852757`*^9, 3.624357283923601*^9}, {3.624357368437821*^9, 
   3.6243574233982267`*^9}, {3.624357463794117*^9, 3.624357491948555*^9}, {
   3.624357583154378*^9, 3.624357586584035*^9}, {3.624362433226262*^9, 
   3.6243624382213173`*^9}, {3.624397744311956*^9, 3.624398021737981*^9}, {
   3.6243980848108873`*^9, 3.624398181033285*^9}, {3.624398301401956*^9, 
   3.624398418672469*^9}, {3.624398650426689*^9, 3.624398662112002*^9}, {
   3.6243986951107073`*^9, 3.624398778451647*^9}, {3.624399032218852*^9, 
   3.624399039310712*^9}, {3.624399087969818*^9, 3.6243991387971907`*^9}}],

Cell[CellGroupData[{

Cell["A hand experiment Section", "Subsubsection",
 CellChangeTimes->{{3.624655528632415*^9, 3.624655536874833*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bitcode", "=", "\"\<../build/180x120/cgpop.bc.llvm.180x120\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P360", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"360", ",", "bitcode", ",", "\"\<../build/180x120/360.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P180", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"180", ",", "bitcode", ",", "\"\<../build/180x120/180.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P120", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"120", ",", "bitcode", ",", "\"\<../build/180x120/120.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P96", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"96", ",", "bitcode", ",", "\"\<../build/180x120/96.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P48", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"48", ",", "bitcode", ",", "\"\<../build/180x120/48.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P36", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"36", ",", "bitcode", ",", "\"\<../build/180x120/36.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P24", "=", 
   RowBox[{"ProfileLoad", "[", 
    RowBox[{"24", ",", "bitcode", ",", "\"\<../build/180x120/24.out\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PAll", "=", 
   RowBox[{"{", 
    RowBox[{"P48", ",", "P96", ",", "P120", ",", "P180", ",", "P360"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPAll", "=", 
   RowBox[{"{", 
    RowBox[{"P24", ",", "P36"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"blocks", "=", 
   RowBox[{"BlockName", "[", 
    RowBox[{"ProfileHotLoad", "[", 
     RowBox[{"120", ",", "bitcode", ",", "\"\<../build/180x120/120.out\>\""}],
      "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fit", "=", 
   RowBox[{"FitLoad", "[", 
    RowBox[{"bitcode", ",", "PAll"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyjtIQmEAhuFjl6GwxanspiEumjQEhQ1lKQRtDpYESSeOkhitaaUhXZDc
IossKBHBxUBCKBAJ7CQW1ZC3inLrokUQiZBF/3eGl2d5xfSslqmiKKqJBMsy
afSWKqj088oYDLdt0SliKzNlhj5+3gW98t51eJmX7MFkj9APQ2ffb9Dht3/C
yAbNSxMri2VO80h/Hbx6sNVD1/VOO1SvHoqgQCGwZ4k3TNgBnbT0EbIdiSd4
7NX85Yj3R9aGO6Iul1VCNhDvg4ahgBp2755qoMxijj4Tg5vFJAyxouoX4rvc
VAPnWlYkMFKblkLhxZoM6twlBfwwNGthcbuT88Ros3O/59wBY+6ffUgP+w5g
5nU8BW1fpgz0B8OjFWLJ0jUGFyZmdL9EkSuuh0vLTgYOij1GOE3xByZ5BZUk
0cj5DxmqyWo=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"graph", "[", 
         RowBox[{"i", ",", "PAll", ",", "PPAll", ",", "fit"}], "]"}], ",", 
        RowBox[{"table", "[", 
         RowBox[{"i", ",", "PAll", ",", "PPAll", ",", "fit"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "blocks"}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
   "TableForm"}], ">>", "\"\</tmp/180x120.m\>\""}]], "Input",
 CellChangeTimes->{{3.6243269620838823`*^9, 3.624327007215569*^9}, {
  3.62435546171107*^9, 3.624355493025177*^9}, {3.624355547204793*^9, 
  3.624355553131419*^9}, {3.624356165082304*^9, 3.62435616542939*^9}, {
  3.624357502964143*^9, 3.624357503556505*^9}, {3.624357830601802*^9, 
  3.624357833899516*^9}, {3.6243578717604847`*^9, 3.6243578904261217`*^9}, {
  3.624357937061223*^9, 3.624357938555476*^9}, {3.624358021081155*^9, 
  3.624358046775077*^9}, {3.624358270117331*^9, 3.62435829378866*^9}, {
  3.6243583257987213`*^9, 3.624358351135837*^9}, {3.6243584077713947`*^9, 
  3.6243584128390217`*^9}, {3.624358490327786*^9, 3.62435849054949*^9}, {
  3.624361952898507*^9, 3.624361955495194*^9}}],

Cell["\<\
open a new document and input <<\[CloseCurlyDoubleQuote]/tmp/180x120.m\
\[CloseCurlyDoubleQuote] to get result.\
\>", "Text",
 CellChangeTimes->{{3.624602150162798*^9, 3.6246021669569607`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["A Template Section", "Subsubsection",
 CellChangeTimes->{{3.62465550607176*^9, 3.624655519525179*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"commented", " ", "would", " ", "crash"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$nprocs", "=", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<180x120\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "24", ",", "36", ",", "48", ",", "96", ",", "120", ",", "180", ",", 
          "360"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<120x80\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "96", ",", "192", ",", "264", ",", "384", ",", "480", ",", "576", 
          ",", "672", ",", "768"}], "}"}]}], ",", 
       RowBox[{"(*", "48", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<60x40\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"360", ",", "576", ",", "708", ",", "948", ",", "1416"}], 
         "}"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$cgpop", "=", "\"\<cgpop\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$archdir", "=", "\"\<llvm\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$pe", "=", "\"\<60x40\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$testNum", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$train", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"$nprocs", "[", "$pe", "]"}], ",", 
       RowBox[{"-", "$testNum"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$test", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"$nprocs", "[", "$pe", "]"}], ",", 
       RowBox[{"-", "$testNum"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dir", "=", 
     RowBox[{"\"\<../build/\>\"", "<>", "$pe", "<>", "\"\</\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bitcode", "=", 
     RowBox[{
     "Dir", "<>", "$cgpop", "<>", "\"\<.bc.\>\"", "<>", "$archdir", "<>", 
      "\"\<.\>\"", "<>", "$pe"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Train", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ProfileLoad", "[", 
        RowBox[{"sz", ",", "bitcode", ",", 
         RowBox[{"Dir", "<>", 
          RowBox[{"ToString", "[", "sz", "]"}], "<>", "\"\<.out\>\""}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"sz", ",", "$train"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Test", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ProfileLoad", "[", 
        RowBox[{"sz", ",", "bitcode", ",", 
         RowBox[{"Dir", "<>", 
          RowBox[{"ToString", "[", "sz", "]"}], "<>", "\"\<.out\>\""}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"sz", ",", "$test"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blocks", "=", 
     RowBox[{"BlockName", "[", 
      RowBox[{"ProfileHotLoad", "[", 
       RowBox[{
        RowBox[{"First", "[", "$test", "]"}], ",", "bitcode", ",", 
        RowBox[{"Dir", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"First", "[", "$test", "]"}], "]"}], "<>", 
         "\"\<.out\>\""}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fit", "=", 
     RowBox[{"FitLoad", "[", 
      RowBox[{"bitcode", ",", "Train"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6243591342992887`*^9, 3.624359336474868*^9}, {
   3.624359403188675*^9, 3.624359403704049*^9}, 3.624359494227994*^9, {
   3.624394737344046*^9, 3.624394742009334*^9}, {3.624395391592514*^9, 
   3.6243954017449617`*^9}, 3.6243955074861803`*^9, {3.624603624843896*^9, 
   3.6246039792427807`*^9}, {3.624617624233851*^9, 3.624617651578835*^9}, {
   3.624655344722715*^9, 3.6246553727926188`*^9}, {3.624655410984907*^9, 
   3.6246554129979067`*^9}, {3.624655459130361*^9, 3.624655493956819*^9}, 
   3.624655553853682*^9, {3.624656935915504*^9, 3.624656957375824*^9}, {
   3.624658994361937*^9, 3.624659116366148*^9}, {3.624659524943268*^9, 
   3.624659561919387*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.624659109912922*^9}]
}, Open  ]],

Cell["\<\
run following code to get a report for top 20 fit result
open a new document and input <<\[CloseCurlyDoubleQuote]/tmp/$pe.m\
\[CloseCurlyDoubleQuote] to read result.\
\>", "Text",
 CellChangeTimes->{{3.624604246154087*^9, 3.6246042759411707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"graph", "[", 
         RowBox[{"i", ",", "Train", ",", "Test", ",", "fit"}], "]"}], ",", 
        RowBox[{"table", "[", 
         RowBox[{"i", ",", "Train", ",", "Test", ",", "fit"}], "]"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "blocks"}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
   "Column"}], ">>", 
  RowBox[{"\"\</tmp/\>\"", "<>", "$pe", "<>", "\"\<.m\>\""}]}]], "Input",
 CellChangeTimes->{{3.624359359250301*^9, 3.624359382782988*^9}, 
   3.624359725272799*^9, 3.624360120512759*^9, {3.624360178538711*^9, 
   3.624360182844572*^9}, {3.624360220012785*^9, 3.624360282253525*^9}, {
   3.6243619013867683`*^9, 3.624361927395666*^9}, {3.624603985445448*^9, 
   3.624604009915984*^9}}],

Cell["run following code to generat all fit graph for all blocks", "Text",
 CellChangeTimes->{{3.624602150162798*^9, 3.624602180808979*^9}, {
  3.624604016921036*^9, 3.624604017426824*^9}, {3.624604270077697*^9, 
  3.624604298258513*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"FileExistsQ", "[", "\"\</tmp/png\>\"", "]"}]}], ",", 
    RowBox[{"CreateDirectory", "[", "\"\</tmp/png\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\</tmp/png/\>\"", "<>", "i", "<>", "\"\<.gif\>\""}], ",", 
      RowBox[{"graph", "[", 
       RowBox[{"i", ",", "Train", ",", "Test", ",", "fit"}], "]"}], ",", 
      "\"\<GIF\>\""}], "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"BlockName", "[", 
       RowBox[{"First", "[", "Test", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.624604303523902*^9, 3.6246043549565973`*^9}, {
  3.6246043858516073`*^9, 3.6246043899110813`*^9}, {3.624616948915784*^9, 
  3.624616980605867*^9}, {3.6246552463617764`*^9, 3.6246552465330677`*^9}, {
  3.624656988583746*^9, 3.624657053687428*^9}, {3.624657150401101*^9, 
  3.624657158268753*^9}, {3.624657197024035*^9, 3.6246572031906967`*^9}, {
  3.624657241081192*^9, 3.624657244365271*^9}, {3.624657291608569*^9, 
  3.624657295190784*^9}}]
}, Open  ]]
},
WindowSize->{1022, 515},
WindowMargins->{{Automatic, 92}, {-9, Automatic}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[596, 22, 9567, 239, 1089, "Input",
 InitializationCell->True],
Cell[10166, 263, 11817, 372, 1123, "Input",
 InitializationCell->True],
Cell[21986, 637, 3240, 81, 438, "Input",
 InitializationCell->True],
Cell[25229, 720, 10947, 247, 742, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[36201, 971, 116, 1, 35, "Subsubsection"],
Cell[36320, 974, 2583, 67, 275, "Input"],
Cell[38906, 1043, 1213, 25, 55, "Input"],
Cell[40122, 1070, 203, 4, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40362, 1079, 108, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[40495, 1084, 4107, 102, 429, "Input"],
Cell[44605, 1188, 70, 1, 32, "Output"]
}, Open  ]],
Cell[44690, 1192, 257, 5, 51, "Text"],
Cell[44950, 1199, 860, 21, 55, "Input"],
Cell[45813, 1222, 238, 3, 31, "Text"],
Cell[46054, 1227, 1234, 28, 99, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
